# knowledge
# ft
femtotesla 
- unit of magnetic flux density
- 1 femtotesla (fT) = 10^-15 tesla (T)
# chcek_decoding
對所有is_word的average response

first 5 rows of epochs.metadata
|    | story   |   story_uid |   sound_id | kind    |   start | sound                   |   onset |   duration | orig_time                 | phoneme   |   sequence_id | condition   |   word_index |   speech_rate | voice   |   pronounced |   word |   intercept | voiced   | is_word   |   wordfreq |   half |   task |   session |
|----|---------|-------------|------------|---------|---------|-------------------------|---------|------------|---------------------------|-----------|---------------|-------------|--------------|---------------|---------|--------------|--------|-------------|----------|-----------|------------|--------|--------|-----------|
|  0 | lw1     |           0 |          0 | phoneme |    0    | stimuli/audio/lw1_0.wav |  23.506 |       0.08 | 2000-01-01 00:00:00+00:00 | t_B       |             0 | sentence    |            0 |           205 | Allison |            1 |    nan |           1 | False    | False     |     nan    |      0 |      0 |         0 |
|  1 | lw1     |           0 |          0 | phoneme |    0.08 | stimuli/audio/lw1_0.wav |  23.586 |       0.09 | 2000-01-01 00:00:00+00:00 | eh_I      |             0 | sentence    |            0 |           205 | Allison |            1 |    nan |           1 | True     | True      |       3.66 |      0 |      0 |         0 |
|  2 | lw1     |           0 |          0 | phoneme |    0.17 | stimuli/audio/lw1_0.wav |  23.676 |       0.07 | 2000-01-01 00:00:00+00:00 | r_I       |             0 | sentence    |            0 |           205 | Allison |            1 |    nan |           1 | True     | False     |     nan    |      0 |      0 |         0 |
|  3 | lw1     |           0 |          0 | phoneme |    0.24 | stimuli/audio/lw1_0.wav |  23.746 |       0.06 | 2000-01-01 00:00:00+00:00 | ah_E      |             0 | sentence    |            0 |           205 | Allison |            1 |    nan |           1 | True     | False     |     nan    |      0 |      0 |         0 |
|  4 | lw1     |           0 |          0 | phoneme |    0.31 | stimuli/audio/lw1_0.wav |  23.816 |       0.06 | 2000-01-01 00:00:00+00:00 | s_B       |             0 | sentence    |            1 |           205 | Allison |            1 |    nan |           1 | False    | False     |     nan    |      0 |      0 |         0 |


meta
|    | story   |   story_uid |   sound_id | kind    |   start | sound   |word_index |   speech_rate | voice   |   pronounced | word    |
|----|---------|-------------|------------|---------|---------|----------------------|---------------|---------|--------------|---------|
|  0 | lw1     |           0 |          0 | sound   |    0    | stimuli/au
       nan |           nan | nan     |          nan | nan     |
|  1 | lw1     |           0 |          0 | phoneme |    0    | stimuli/au
         0 |           205 | Allison |            1 | nan     |
|  2 | lw1     |           0 |          0 | word    |    0    | stimuli/au
         0 |           205 | Allison |            1 | Tara    |
|  3 | lw1     |           0 |          0 | phoneme |    0.08 | stimuli/au
         0 |           205 | Allison |            1 | nan     |
|  4 | lw1     |           0 |          0 | phoneme |    0.17 | stimuli/au
         0 |           205 | Allison |            1 | nan     |
|  5 | lw1     |           0 |          0 | phoneme |    0.24 | stimuli/au
         0 |           205 | Allison |            1 | nan     |
|  6 | lw1     |           0 |          0 | phoneme |    0.31 | stimuli/au
         1 |           205 | Allison |            1 | nan     |
|  7 | lw1     |           0 |          0 | word    |    0.31 | stimuli/au
         1 |           205 | Allison |            1 | stood   |
|  8 | lw1     |           0 |          0 | phoneme |    0.37 | stimuli/au
         1 |           205 | Allison |            1 | nan     |
|  9 | lw1     |           0 |          0 | phoneme |    0.41 | stimuli/au
         1 |           205 | Allison |            1 | nan     |
| 10 | lw1     |           0 |          0 | phoneme |    0.49 | stimuli/au
         1 |           205 | Allison |            1 | nan     |
| 11 | lw1     |           0 |          0 | phoneme |    0.55 | stimuli/au
         2 |           205 | Allison |            1 | nan     |
| 12 | lw1     |           0 |          0 | word    |    0.55 | stimuli/au
         2 |           205 | Allison |            1 | stock   |
| 13 | lw1     |           0 |          0 | phoneme |    0.6  | stimuli/au
         2 |           205 | Allison |            1 | nan     |
| 14 | lw1     |           0 |          0 | phoneme |    0.67 | stimuli/au
         2 |           205 | Allison |            1 | nan     |
| 15 | lw1     |           0 |          0 | phoneme |    0.79 | stimuli/au
         2 |           205 | Allison |            1 | nan     |
| 16 | lw1     |           0 |          0 | phoneme |    1.08 | stimuli/au
         3 |           205 | Allison |            1 | nan     |
| 17 | lw1     |           0 |          0 | word    |    1.08 | stimuli/au
         3 |           205 | Allison |            1 | still   |
| 18 | lw1     |           0 |          0 | phoneme |    1.16 | stimuli/au
         3 |           205 | Allison |            1 | nan     |
| 19 | lw1     |           0 |          0 | phoneme |    1.23 | stimuli/au
         3 |           205 | Allison |            1 | nan     |
| 20 | lw1     |           0 |          0 | phoneme |    1.34 | stimuli/au
         3 |           205 | Allison |            1 | nan     |
| 21 | lw1     |           0 |          0 | phoneme |    1.63 | stimuli/au
         4 |           205 | Allison |            1 | nan     |
| 22 | lw1     |           0 |          0 | word    |    1.63 | stimuli/au
         4 |           205 | Allison |            1 | waiting |
| 23 | lw1     |           0 |          0 | phoneme |    1.77 | stimuli/au
         4 |           205 | Allison |            1 | nan     |
| 24 | lw1     |           0 |          0 | phoneme |    1.84 | stimuli/au         4 |           205 | Allison |            1 | nan    
 |
| 25 | lw1     |           0 |          0 | phoneme |    1.89 | stimuli/au         4 |           205 | Allison |            1 | nan     | stimuli/au
 |
| 24 | lw1     |           0 |          0 | phoneme |    1.84 | stimuli/au+00:00 | t_I       |             0 | sentence    |    nan     |
         4 |           205 | Allison |            1 | nan     |
| 25 | lw1     |           0 |          0 | phoneme |    1.89 | stimuli/au+00:00 | ih_I      |             0 | sentence    |       1.96 | stimuli/au         4 |           205 | Allison |            1 | nan     |
   |            5 |           205 | Allison |            1 | for     |
| 29 | lw1     |           0 |          0 | phoneme |    2.09 | stimuli/audio/lw1_0.wav   |  25.596 |       0.08 | 2000-01-01 00:00:00+00:00 | er_E      |             0 | sentence    |            5 |           205 | Allison |            1 | nan     |

# decod

## decode for word freq
### y
```python
print(f"type of y: {type(y)}")
print(f"shape of y: {y.shape}")
print("first 5 rows of y")
pprint(y[:5])
>>> type of y: <class 'numpy.ndarray'
>>> shape of y: (668,)
>>> first 5 rows of y
>>> array([3.66, 4.57, 4.93, 5.92, 5.06])
```
### X

```python
print("type of X:", type(X))
print("shpae of X:", X.shape)
>>> type of X: <class 'numpy.ndarray'>
>>> shpae of X: (668, 208, 81) (should be 668 sample * 208 channels * 81 timepoints)

```

## whats decode doing?

 predict the word frequency (y) based on the neural data (X)

## meta in decod

### before reset index, first 5 rows of meta:
|    | story | story_uid | sound_id | kind    | start | sound                  | onset  | duration | orig_time                  | phoneme | sequence_id | condition | word_index | speech_rate | voice   | pronounced | word | intercept | voiced | is_word | wordfreq | half | task | session | label   |
|----|-------|-----------|----------|---------|-------|------------------------|--------|----------|----------------------------|---------|-------------|-----------|------------|-------------|---------|------------|------|-----------|--------|---------|----------|-------|------|---------|---------|
|  1 | lw1   |         0 |        0 | phoneme |  0.08 | stimuli/audio/lw1_0.wav | 23.586 |     0.09 | 2000-01-01 00:00:00+00:00 | eh_I    |           0 | sentence  |          0 |         205 | Allison |          1 |  nan |         1 | True   | True    |     3.66 |     0 |    0 |       0 | t0_s0_h0 |
|  5 | lw1   |         0 |        0 | phoneme |  0.37 | stimuli/audio/lw1_0.wav | 23.876 |     0.04 | 2000-01-01 00:00:00+00:00 | t_I     |           0 | sentence  |          1 |         205 | Allison |          1 |  nan |         1 | False  | True    |     4.57 |     0 |    0 |       0 | t0_s0_h0 |
|  9 | lw1   |         0 |        0 | phoneme |  0.6  | stimuli/audio/lw1_0.wav | 24.106 |     0.07 | 2000-01-01 00:00:00+00:00 | t_I     |           0 | sentence  |          2 |         205 | Allison |          1 |  nan |         1 | False  | True    |     4.93 |     0 |    0 |       0 | t0_s0_h0 |
| 13 | lw1   |         0 |        0 | phoneme |  1.16 | stimuli/audio/lw1_0.wav | 24.666 |     0.07 | 2000-01-01 00:00:00+00:00 | t_I     |           0 | sentence  |          3 |         205 | Allison |          1 |  nan |         1 | False  | True    |     5.92 |     0 |    0 |       0 | t0_s0_h0 |
| 17 | lw1   |         0 |        0 | phoneme |  1.77 | stimuli/audio/lw1_0.wav | 25.276 |     0.07 | 2000-01-01 00:00:00+00:00 | ey_I    |           0 | sentence  |          4 |         205 | Allison |          1 |  nan |         1 | True   | True    |     5.06 |     0 |    0 |       0 | t0_s0_h0 |

>> 這index就是在原本epochs.metadata 裡的index
1,5,9,.. 是因為第1,5,9,.. row is_word才是true
--------------------

### after reset index, first 5 rows of meta:
|    | index | story | story_uid | sound_id | kind    | start | sound                  | onset  | duration | orig_time                  | phoneme | sequence_id | condition | word_index | speech_rate | voice   | pronounced | word | intercept | voiced | is_word | wordfreq | half | task | session | label   |
|----|-------|-------|-----------|----------|---------|-------|------------------------|--------|----------|----------------------------|---------|-------------|-----------|------------|-------------|---------|------------|------|-----------|--------|---------|----------|-------|------|---------|---------|
|  0 |     1 | lw1   |         0 |        0 | phoneme |  0.08 | stimuli/audio/lw1_0.wav | 23.586 |     0.09 | 2000-01-01 00:00:00+00:00 | eh_I    |           0 | sentence  |          0 |         205 | Allison |          1 |  nan |         1 | True   | True    |     3.66 |     0 |    0 |       0 | t0_s0_h0 |
|  1 |     5 | lw1   |         0 |        0 | phoneme |  0.37 | stimuli/audio/lw1_0.wav | 23.876 |     0.04 | 2000-01-01 00:00:00+00:00 | t_I     |           0 | sentence  |          1 |         205 | Allison |          1 |  nan |         1 | False  | True    |     4.57 |     0 |    0 |       0 | t0_s0_h0 |
|  2 |     9 | lw1   |         0 |        0 | phoneme |  0.6  | stimuli/audio/lw1_0.wav | 24.106 |     0.07 | 2000-01-01 00:00:00+00:00 | t_I     |           0 | sentence  |          2 |         205 | Allison |          1 |  nan |         1 | False  | True    |     4.93 |     0 |    0 |       0 | t0_s0_h0 |
|  3 |    13 | lw1   |         0 |        0 | phoneme |  1.16 | stimuli/audio/lw1_0.wav | 24.666 |     0.07 | 2000-01-01 00:00:00+00:00 | t_I     |           0 | sentence  |          3 |         205 | Allison |          1 |  nan |         1 | False  | True    |     5.92 |     0 |    0 |       0 | t0_s0_h0 |
|  4 |    17 | lw1   |         0 |        0 | phoneme |  1.77 | stimuli/audio/lw1_0.wav | 25.276 |     0.07 | 2000-01-01 00:00:00+00:00 | ey_I    |           0 | sentence  |          4 |         205 | Allison |          1 |  nan |         1 | True   | True    |     5.06 |     0 |    0 |       0 | t0_s0_h0 |

>> 這會把index重新設成0,1,2,3...

# Learning Resources
## LDA Tutorial
https://www.youtube.com/watch?v=9IDXYHhAfGA

# Dimension problem of X, y in LDA
In the context of the provided code, `X` is a 3D array with dimensions `(n, nchans, ntimes)`, where:
- `n` is the number of samples.
- `nchans` is the number of channels or features.
- `ntimes` is the number of time points.

When fitting the model and making predictions, the code iterates over the `ntimes` dimension. For each time point `t`, the model is trained and predictions are made. This means that for each `t`, the model is working with a 2D slice of `X` with dimensions `(n, nchans)`.

### Explanation

1. **3D Array `X`:**
   - `X` has the shape `(n, nchans, ntimes)`.
   - For each time point `t`, `X[:, :, t]` is a 2D array with shape `(n, nchans)`.

2. **2D Array `y`:**
   - `y` is a 1D array with shape `(n,)`, representing the target labels for each sample.
   - When fitting the model for a specific time point `t`, `y` remains the same because it corresponds to the samples, not the time points.

### Why `t` is the 3rd Dimension of `X` but Becomes the 2nd Dimension in Predictions

- **In `X`:** The third dimension (`ntimes`) represents different time points. When you slice `X` for a specific time point `t`, you get a 2D array `(n, nchans)` for that time point.
- **In Predictions:** When making predictions for each time point `t`, you store the results in a 3D array `preds` with shape `(n, ntimes, 2)`. Here, `ntimes` is the second dimension because you are storing predictions for each sample and each time point.

### Example

Consider the following simplified example:

- `X` has shape `(100, 64, 10)`, meaning 100 samples, 64 channels, and 10 time points.
- `y` has shape `(100,)`, meaning 100 samples.

For each time point `t` (from 0 to 9):
- `X[:, :, t]` has shape `(100, 64)`.
- `y` remains `(100,)`.

When storing predictions:
- `preds` has shape `(100, 10, 2)`, where:
  - `100` is the number of samples.
  - `10` is the number of time points.
  - `2` is the number of classes (probabilities for each class).

### Code Context

In the provided code snippet:
```python
for t in range(ntimes):
    model.fit(X_train[:, :, t], y_train)
    preds[:, t, :] = model.predict_proba(X_test[:, :, t])
```
- `X_train[:, :, t]` and `X_test[:, :, t]` are 2D slices of `X` for the time point `t`.
- `y_train` and `y_test` correspond to the samples.
- Predictions are stored in `preds` with `t` as the second dimension to keep track of predictions for each time point.

